<% include ../header.ejs%>

<div style="position:relative;width:100%;height:100%">
    <!--Layout-->
    <div class="site-layout">
            <!--Header Toolbar-->
            <!--Header Toolbar Close-->

            <!--Header-->
        <% include ../center/_nav_head.ejs%>
            <div class="page double-padding-bottom">
                <div class="container page-content">
                    <div class="row space-top" >
                        <!-- Sidebar-->
                        <% var active = "carousel"; %>
                        <% include ../center/_nav_customer_left.ejs%>
                        <!-- Sidebar CLose-->
                        <section class="col-md-10 pull-right space-bottom">
                            <div class="filterDivTab">
                                <% var curtTab = 'carousel' %>
                                <% include portalTab.ejs %>
                            </div>
                            <div class="col-sm-12 form-horizontal" style="border: 1px solid #e6e6e6;margin-top: -1px;">
                                <%var currentCarousel=data.carousel%>
                                <%var editBool=currentCarousel!=null%>
                                <div style="margin-bottom:20px"></div>
                                <div class="form-group">
                                    <div class="col-sm-2">
                                        <span >轮播图片:</span>
                                        <input type="hidden" id="carousel_HiddenId" value="<%=editBool?currentCarousel.id:null%>"/>
                                    </div>
                                    <div class="col-sm-10">
                                        <form class="form-signin" action="/rest/customer/portal/carousel/upload"  role="form" method="post" enctype='multipart/form-data' target="picture">
                                            <input id="fulAvatar" name="fulAvatar" class="btn btn-small" type="file" class="form-control"  accept="image/*" style="border: 0px;float: left"/>
                                            <button id="btnSub1" class="btn  btn-primary"  type="submit">上 传</button>
                                        </form>
                                        <iframe name="picture" id="picture" style = "text-align: center" data-url="<%= editBool?currentCarousel.imgurl:null%>">
                                        </iframe>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-sm-2"><span >广告名称:</span></div>
                                    <div class="col-sm-10"><input type="text" class="adInput" id="carouselName" value="<%=editBool?currentCarousel.name:null%>"/></div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span >链接地址:</span></div>
                                    <div class="col-sm-10"><input type="text"  class="adInput" id="carouselUrl" value="<%=editBool?currentCarousel.url:null%>" /></div><!--style="width:300px"-->
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span >生效时间:</span></div>
                                    <div class="col-sm-10"><input type="text" class="adInput cDatePicker" id="carouselBeginAt"   value="<%=editBool?currentCarousel.beginAt:null%>" /></div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span >失效时间:</span></div>
                                    <div class="col-sm-10"><input type="text" class="adInput cDatePicker" id="carouselEndAt"  value="<%=editBool?currentCarousel.endAt:null%>" /></div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span >图片说明:</span></div>
                                    <div class="col-sm-10">
                                        <div><textarea  oninput="LimitTextAreaContentLength()" id="displayText"     style="  resize: none;width: 443px; height: 101px;" ><%=editBool?currentCarousel.displayText:null%></textarea></div>
                                        <div style="font-size:13px"><span>最多104个字符,当前<span id="wordsLength"><%=editBool?currentCarousel.displayText.length:0%></span>个字符</span></div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span >备注:</span></div>
                                    <div class="col-sm-10"><textarea maxlength="110" placeholder="添加备注" id="carouselRemark" style=" resize: none;width: 443px; height: 101px;" ><%=editBool?currentCarousel.remark:null%></textarea></div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-2"><span ></span></div>
                                    <div class="col-sm-10">
                                        <a class="btn btn-primary" href="javascript:void(0)" id="carouselSaveBtn">保存</a>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
    <% include ../_nav_bottom.ejs%>
</div>
<% include  ../footer.ejs %>
<script src="/static/js/moment.js"></script>
<script src="/static/source/js/portal.js"></script>
<script>
    var str = $("#picture").attr("data-url") ? $("#picture").attr("data-url") : "";
    if(str!==null&&str!==undefined&&str!=="") {
        var imgHtml = '<img src="' + str + '" style="width:150px;height:120px" />';
        $("#picture").contents().find('body').html(imgHtml);
    }
    $('.cDatePicker').datetimepicker({
        timepicker: true,
        format:'Y-m-d H:i',
    });
    $(function(){
        if($('#carousel_HiddenId').val()==null||$('#carousel_HiddenId').val()==''){
          $('#carouselBeginAt').val(moment(new Date()).format('YYYY-MM-DD HH:mm'));
          $('#carouselEndAt').val(moment(new Date()).add(3,"months").format('YYYY-MM-DD HH:mm'));
        }
    });
    function LimitTextAreaContentLength(){
        var length=$.trim($('#displayText').val()).length;
        if(length>=104){
            $('#wordsLength').css('color','red');
            $('#displayText').val($.trim($('#displayText').val()).substr(0,104));
        }
        else{
            $('#wordsLength').css('color','black');
        }
        length=$.trim($('#displayText').val()).length;
        $('#wordsLength').html(length);
    }
</script>
