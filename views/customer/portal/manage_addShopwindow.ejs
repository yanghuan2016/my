<% include ../header.ejs%>
<div style="position:relative;width:100%;height:100%;" id="test">
    <!--Layout-->
    <div class="site-layout">
            <!--Header-->
            <% include ../center/_nav_head.ejs%>
            <div class="page double-padding-bottom">
                <div class="container page-content">
                    <div class="row space-top" >
                        <!-- Sidebar-->
                        <% var active = "carousel"; %>
                        <% include ../center/_nav_customer_left.ejs%>
                        <!-- Sidebar CLose-->
                        <section class="col-md-10 pull-right space-bottom">
                            <div class="filterDivTab">
                                <div class="tabList">
                                    <a href="/page/customer/portal/carousel">首页广告设置</a>
                                    <a href="/page/customer/portal/news">新闻发布</a>
                                    <a href="/page/customer/portal/showcase" class="itemActive">橱窗设置</a>
                                    <a href="/page/customer/portal/linkColumn/all">页脚设置</a>
                                    <a href="/page/customer/portal/complaints">投诉电话管理</a>
                                </div>
                            </div>
                            <div class="col-sm-12 form-horizontal" style="border: 1px solid #e6e6e6;margin-top: -1px;">
                                <div style="margin-bottom:20px"></div>

                                <%var isEdit=data.showcase!=null%>
                                <div class="form-group">
                                    <div  >
                                        <span >橱窗名称:</span>
                                    </div>
                                    <div class="col-sm-10" ></div>
                                </div>
                                <div class="form-group">
                                    <div class="padding-two-side">
                                        <input type="hidden" id="showcaseHiddenId" value="<%=isEdit?data.showcase.id:null%>"/>
                                        <input type="text" class="form-control" id="name"
                                               value="<%=isEdit?data.showcase.name:null%>"    placeholder="">
                                    </div>
                                </div>

                                <div class="form-group clear-margin-bottom"  style="margin-bottom:0">
                                    <div class="col-sm-12 page-content-right-head">
                                        <span>橱窗产品</span>
                                    </div>

                                </div>
                            </div>



                            <div class=" form-horizontal" style="margin-bottom:10px">

                                <section class=" col-sm-12">

                                    <div class="page-content">
                                        <div class="page-content-right">
                                      <table class="table page-table space-bottom"  id="showcaseGoodsTable">
                                        <thead class="page-content-right-head">
                                        <tr>
                                            <td  class="goods-name-info goods-info-img">产品名称</td>

                                            <td>货号</td>
                                            <td>库存</td>
                                            <td>排序</td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <%var showcaseGoods=data.showcaseGoods%>
                                        <%var showcaseGoodsLength=showcaseGoods&&showcaseGoods.length%>
                                        <%for(var i=0;i<showcaseGoodsLength;i++){%>
                                        <%var item=showcaseGoods[i]%>

                                        <tr>
                                            <td>
                                                <div class="goods-img">
                                                    <img src="<%= (item.imgSrc=="undefined"||item.imgSrc==null||item.imgSrc==null)?"/static/img/index/noPic.png":item.imgSrc%>"/>
                                                </div>
                                                <div class="goods-info decreaseMargin">
                                                    <h6><a href="/goods/detail?goodsId=<%=item.productId %>"><%=item.commonName%></a></h6>
                                                    <h6><%=item.producer%></h6>
                                                    <h6><%=item.spec + '/'+(item.measureUnit==null?"无":item.measureUnit)%></h6>
                                                </div>
                                            </td>
                                            <td>
                                                <%=item.productCode%>
                                            </td>
                                            <td>
                                                <%=item.amount?item.amount+"件":"暂无信息"%>
                                            </td>

                                            <td>
                                                <a  href="javascript:void(0)"  data-id="<%=item.productId%>" class="updateSCGoodOrderBtn">
                                                    <i class="fa fa-arrow-circle-up tooltipped" data-toggle="tooltip" data-placement="left" title="置顶" style="margin-right: 2px"></i>
                                                </a>


                                                <a  href="javascript:void(0)" data-id="<%=item.productId%> " class="deleteSCGoodBtn">
                                                    <i class="fa fa-remove tooltipped" data-toggle="tooltip" data-sctype="scLIST" data-placement="left" title="删除" style="margin-right: 2px"></i>
                                                </a>
                                            </td>


                                        </tr>

                                        <%}%>


                                        </tbody>
                                    </table>

                                        </div>
                                    </div>
                                </section>


                            </div>

                            <div id="saveBtnDisplay" class="col-sm-12 form-horizontal" style="display:block;margin-top:10px">
                                <div class="form-group" >
                                    <div class="col-sm-10" style="line-height:38px" >
                                        <span style="color: #A0BBCA; float:right">修改橱窗名或改变商品顺序后请记得保存</span>
                                    </div>
                                    <div class="col-sm-2">
                                        <button class="btn btn-primary"   id="saveSCGoodsBtn">
                                            <i class="fa fa-save"></i>
                                            保存
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!--选择商品iframe-->
                        <div id="chooseGoodsDiv" class="container page-content">
                            <!--第一种-->
                            <% var isUndefined=data.showCaseGoodsIds!="undefined"%>
                            <% var params=data.showCaseGoodsIds.length!=0?data.showCaseGoodsIds.join(','):"" %>
                            <% var hasGoods=params!=""%>
                            <!--第二种方法iframe-->
                            <div class="row">
                                <section class="col-md-10 pull-right">
                                    <iframe id="showcaseChooseGoodsIframe" src="/goods/showcase?flag=chooseGoods<%= hasGoods?"&ids="+params:null%>"></iframe>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <% include ../_nav_bottom.ejs%>
    </div>
</div>
<% include  ../footer.ejs %>
<script>

    $(function(){
        //将最初的商品存入本地缓存
        var currentSCGids=[];
        $('.updateSCGoodOrderBtn').map(function(){
            currentSCGids.push($(this).attr('data-id'));
        });
        localStorage.currentShowCaseGoodsIds=currentSCGids;
    })

</script>
<script src="/static/source/js/portal.js"></script>