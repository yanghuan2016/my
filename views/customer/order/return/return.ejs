<% include ../../header.ejs%>
<%
var paginator = data.paginator || {};
var pageSize = parseInt(paginator.ps) || 10;
var page = parseInt(paginator.p) || 1;
%>
<div style="position:relative;width:100%;height:100%;">
    <!--Layout-->
    <div class="site-layout">
            <!--Header Toolbar-->
            <% include ../../_nav_top.ejs %>
            <!--Header Toolbar Close-->

            <!--Header-->
            <% include ../../_nav_head.ejs%>
            <!--Header Close-->

            <!--Page Content--><!-- InstanceBeginEditable name="content" -->
            <div class="page">

                <div class="container">
                    <div class="row">
                        <!--Sidebar-->
                        <% var active = "return"; %>
                        <% include ../../_order_sidebar.ejs %>
                        <!--Sidebar Close-->
                        <section class="col-md-10 pull-right space-top space-bottom">
                            <div class="filterDiv">
                                <div class="filterHead">
                                    <div>筛选：</div>
                                    <div class="defaultdropdown">
                                        <div class="btn-group">
                                            <button type="button" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <span><% if(paginator.cv != "%") {%>
                                                <%= data._translation.ReturnStatus[paginator.cv]%>
                                                <% } else {%>
                                                全部状态
                                                <% } %></span>
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a class="click-link" href="/order/return">全部状态</a>
                                                </li>
                                                <% for(var key in data._translation.ReturnStatus){%>
                                                <li>
                                                    <% var paginatorData = {
                                                        url : "return?",
                                                        cf : "订单状态",
                                                        cv : key,
                                                        p : 1,
                                                        paginator : paginator
                                                    };
                                                    %>
                                                    <a class="click-link" onclick="joinPaginator(<%= JSON.stringify(paginatorData)%>)"><%= data._translation.ReturnStatus[key]%></a>
                                                </li>
                                                <% } %>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <%
                                var paginator_keywordsValue = '';
                                if (typeof paginator != 'undefined') {
                                    if (typeof paginator.kv != 'undefined') {
                                        paginator_keywordsValue = (paginator.kv == "%") ? "" : paginator.kv;
                                    }
                                }
                                %>
                                <% var placeholder = "请输入退货单号/订单号"%>
                                <% var paginatorData = {
                                    url : "return?",
                                    kv : 'keywordsValueToBeReplaced',
                                    p : 1,
                                    paginator : paginator
                                };
                                %>
                                <% include ../../public/filterInput.ejs%>
                                <% if(!data.returnStrictly){%>
                                <a class="btn btn-primary"  href="/order/return/add">新增退货单</a>
                                <% } %>
                            </div>
                            <div class="space-top">
                                <table class="sm-page-table">
                                    <thead>
                                    <tr>
                                        <td><strong>退货单号</strong></td>
                                        <td><strong>订单号</strong></td>
                                        <td><strong>申请时间</strong></td>
                                        <td><strong>处理状态</strong></td>
                                        <td><strong>笔数/数量/金额</strong></td>
                                        <td><strong>操作</strong></td>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <% if(data.returnInfo.length > 0){ %>
                                    <% var returnInfo = data.returnInfo %>
                                    <% for (var i in returnInfo){%>
                                    <% var item = returnInfo[i]%>
                                    <tr>
                                        <td>
                                            <a href="/order/return/detail?returnId=<%=item.id%>"><%= item.displayReturnId %></a>
                                        </td>
                                        <td>
                                            <%= item.displayOrderId %>
                                        </td>
                                        <td>
                                            <%= item.createdOn %>
                                        </td>
                                        <td>
                                            <%= data._translation.ReturnStatus[item.status] %>
                                        </td>
                                        <td>
                                            <%= item.countBatch %>
                                            /
                                            <%= item.quantity %>
                                            /
                                            &yen;<%= item.subtotal || "金额" %>
                                        </td>
                                        <td>
                                            <% if(item.status == "APPROVED") {%>
                                            <a href="/order/return/detail?returnId=<%=item.id%>" class="tooltipped" title="发货" data-toggle="tooltip" data-placement="left">
                                                <i class="fa fa-send"></i>
                                            </a>
                                            <% } else if(item.status == "CREATED"){%>
                                            <a class="tooltipped cancelReturnDialog" title="取消" data-toggle="tooltip"  returnId="<%=item.id%>"  data-placement="top">
                                                <i class="fa fa-times-circle"></i>
                                            </a>
                                            <% } else {%>
                                            <a  href="/order/return/detail?returnId=<%=item.id%>" class="tooltipped" title="查看" data-toggle="tooltip" data-placement="top">
                                                <i class="fa fa-binoculars"></i>
                                            </a>
                                            <% } %>
                                        </td>
                                    </tr>
                                    <% } %>
                                    <% } else {%>
                                    <tr>
                                        <td colspan="5" style="height: 200px">
                                            <h4 class="blank-content">您目前还没有新的退货信息</h4>
                                        </td>
                                    </tr>
                                    <% } %>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                        <% var url = "return?"%>
                        <% include ../../_paginator.ejs%>
                    </div>
                </div>
            </div>
            <!--Page Content Close-->
        </div><!--Layout Close-->
    <% include ../../_nav_bottom.ejs%>
</div>

<% include ../../footer.ejs %>
<script  type="text/javascript" src="/static/source/js/client/return.js"></script>
